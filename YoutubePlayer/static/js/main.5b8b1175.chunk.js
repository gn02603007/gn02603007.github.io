(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{45:function(e,t,a){e.exports=a(66)},65:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(14),i=a.n(o),s=a(9),c=a(10),r=a(13),d=a(11),u=a(12),m=function(e){function t(){return Object(s.a)(this,t),Object(r.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return""}}]),t}(l.a.Component),g=a(30),h=a(17),p=a(25),y=a.n(p),b=(a(60),a(68)),S=a(72),f=a(69),v=a(70),E=a(42),w=a(71),k=a(44),x=a(43),C=a(20),O=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).titleRef=l.a.createRef(),a.vidRef=l.a.createRef(),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleOnClick",value:function(){var e=this,t=this.props.proceed;return function(){t({title:e.titleRef.current.value,vid:e.vidRef.current.value})}}},{key:"render",value:function(){var e=this.props,t=e.show,a=e.dismiss;return l.a.createElement("div",{className:"static-modal"},l.a.createElement(v.a,{show:t,onHide:a},l.a.createElement(v.a.Body,null,l.a.createElement(E.a,{as:w.a.Row},l.a.createElement(k.a,null,"Title: "),l.a.createElement(x.a,{type:"text",ref:this.titleRef,defaultValue:this.props.title}),l.a.createElement(k.a,null,"VideoID: "),l.a.createElement(x.a,{type:"text",ref:this.vidRef,defaultValue:this.props.vid,placeholder:"Youtube Url or VideoID"}),l.a.createElement(S.a,{className:"button-l",bsStyle:"default",onClick:this.handleOnClick()},"Confirm")))))}}]),t}(l.a.Component),L=Object(C.createConfirmation)(Object(C.confirmable)(O)),N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).nameRef=l.a.createRef(),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleOnClick",value:function(){var e=this,t=this.props.proceed;return function(){t({output:e.nameRef.current.value})}}},{key:"render",value:function(){var e=this.props,t=e.show,a=e.dismiss,n=e.name;return l.a.createElement("div",{className:"static-modal"},l.a.createElement(v.a,{show:t,onHide:a},l.a.createElement(v.a.Body,null,l.a.createElement(E.a,{as:w.a.Row},l.a.createElement(k.a,null,"Title: "),l.a.createElement(x.a,{type:"text",ref:this.nameRef,defaultValue:n}),l.a.createElement(S.a,{className:"button-l",onClick:this.handleOnClick()},"Confirm")))))}}]),t}(l.a.Component),T=Object(C.createConfirmation)(Object(C.confirmable)(N)),j=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(d.a)(t).call(this,e))).loadFile=function(){var e=new FileReader;e.onload=function(e){var t;try{t=JSON.parse(e.target.result),a.setState({list:t}),a.save2LocalStorage()}catch(n){console.log(n.toString())}},e.onerror=function(e){},e.readAsText(a.fileRef.current.files[0],"UTF-8")},a.load=function(e){a.setState({url:e,played:0,loaded:0,pip:!1,playing:!0})},a.loadFromList=function(e){a.handleTogglePlaying(e),a.load("https://www.youtube.com/watch?v="+a.state.list[e.album].songList[e.index].vid)},a.handleChangeList=function(){a.setState({jsonUrl:"data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a.state.list))})},a.handleChangePlayMode=function(){switch(a.state.playMode){case 0:a.setState({playMode:1,playModeSymbol:"\ud83d\udd00"});break;case 1:a.setState({playMode:2,playModeSymbol:"\ud83d\udd02"});break;case 2:a.setState({playMode:-1,playModeSymbol:"\u27a1"});break;default:a.setState({playMode:0,playModeSymbol:"\ud83d\udd01"})}a.save2LocalStorage()},a.handlePlayPause=function(){var e=a.state.playIndex;""===a.state.url&&a.state.list[e.album].songList.length>0&&a.setState({url:"https://www.youtube.com/watch?v="+a.state.list[e.album].songList[e.index].vid}),a.setState({playing:!a.state.playing})},a.handleNext=function(){a.nextSong()},a.handleStop=function(){a.setState({playing:!1})},a.handleToggleControls=function(){var e=a.state.url;a.setState({controls:!a.state.controls,url:null},function(){return a.load(e)})},a.handleToggleLight=function(){a.setState({light:!a.state.light})},a.handleToggleLoop=function(){a.setState({loop:!a.state.loop})},a.handleVolumeChange=function(e){a.setState({volume:parseFloat(e.target.value)}),a.save2LocalStorage()},a.handleToggleMuted=function(){a.setState({muted:!a.state.muted}),a.save2LocalStorage()},a.handleSetPlaybackRate=function(e){a.setState({playbackRate:parseFloat(e.target.value)})},a.handleTogglePIP=function(){a.setState({pip:!a.state.pip})},a.handlePlay=function(){console.log("onPlay"),a.setState({playing:!0})},a.handleEnablePIP=function(){console.log("onEnablePIP"),a.setState({pip:!0})},a.handleDisablePIP=function(){console.log("onDisablePIP"),a.setState({pip:!1})},a.handlePause=function(){console.log("onPause"),a.setState({playing:!1})},a.handleSeekMouseDown=function(e){a.setState({seeking:!0})},a.handleSeekChange=function(e){a.setState({played:parseFloat(e.target.value)}),a.save2LocalStorage()},a.handleSeekMouseUp=function(e){a.setState({seeking:!1}),a.player.seekTo(parseFloat(e.target.value))},a.handleProgress=function(e){a.state.seeking||a.setState(e),a.save2LocalStorage()},a.handleEnded=function(){console.log("onEnded"),a.state.loop?a.setState({playing:a.state.loop}):a.nextSong()},a.nextSong=function(){var e=a.state.playIndex,t=a.state.list;switch(a.state.playMode){case 0:a.loadFromList({album:e.album,index:e.index+1===t[e.album].songList.length?0:e.index+1});break;case 1:for(var n=Math.floor(Math.random()*Math.floor(t[e.album].songList.length));n===e.index&&t[e.album].songList.length>1;)n=Math.floor(Math.random()*Math.floor(t[e.album].songList.length));a.loadFromList({album:e.album,index:n});break;case 2:a.setState({playing:!0});break;default:a.setState({playing:!1})}a.save2LocalStorage()},a.handleDuration=function(e){console.log("onDuration",e),a.setState({duration:e})},a.handleChangeTab=function(e){a.state.viewIndex.album!==e&&(a.setState({viewIndex:{album:e,index:null}}),a.save2LocalStorage())},a.handleToggleSingleClick=function(e){a.setState({viewIndex:e}),a.save2LocalStorage()},a.handleTogglePlaying=function(e){a.setState({playIndex:e,viewIndex:{album:e.album,index:null}}),a.save2LocalStorage()},a.formatTime=function(e,t){var a=new Date(1e3*t),n=("0"+a.getUTCHours()).slice(-2),l=("0"+a.getUTCMinutes()).slice(-2),o=("0"+a.getUTCSeconds()).slice(-2),i=new Date(1e3*e),s=("0"+i.getUTCHours()).slice(-2),c=("0"+i.getUTCMinutes()).slice(-2),r=("0"+i.getUTCSeconds()).slice(-2);return"00"!==n?"".concat(s,":").concat(c,":").concat(r,"/").concat(n,":").concat(l,":").concat(o):"".concat(c,":").concat(r,"/").concat(l,":").concat(o)},a.renderTime=function(e){return a.formatTime(e*a.state.duration,a.state.duration)},a.renderSongList=function(){var e=a.state.viewIndex,t=a.state.playIndex;return a.state.list[e.album].songList.map(function(n,o){return l.a.createElement("tr",{key:o},l.a.createElement("td",{className:"".concat(t.album===e.album&&t.index===o?"playing":""," ").concat(e.index!==o||t.album===e.album&&t.index===o?"":"selected")},l.a.createElement("div",{className:"title",onClick:function(){return a.handleToggleSingleClick({album:a.state.viewIndex.album,index:o})},onDoubleClick:function(){a.handleTogglePlaying({album:a.state.viewIndex.album,index:o}),a.load("https://www.youtube.com/watch?v="+n.vid)}},n.title),l.a.createElement(b.a,{size:"sm","aria-label":o,className:"song-control"},l.a.createElement(S.a,{variant:"secondary",onClick:function(){a.handleEditSongDialog(n.title,n.vid,{album:a.state.viewIndex.album,index:o})}},"Edit"),l.a.createElement(S.a,{variant:"danger",onClick:function(){a.state.list[a.state.viewIndex.album].songList.splice(o,1),a.setState({list:a.state.list}),a.save2LocalStorage(),a.handleChangeList()}},"x"))))})},a.renderTabList=function(){return a.state.list.map(function(e,t){return l.a.createElement(b.a,{size:"sm","aria-label":t,key:t},l.a.createElement(S.a,{variant:t===a.state.viewIndex.album?"light":"dark",onClick:function(){a.handleChangeTab(t)},onDoubleClick:function(){a.handleEditTabDialog(e.tabName,t)}},e.tabName),l.a.createElement(S.a,{variant:"danger",onClick:function(){a.state.list.splice(t,1),t===a.state.viewIndex.album&&a.setState({viewIndex:{album:0,index:null}}),a.setState({list:a.state.list}),a.save2LocalStorage(),a.handleChangeList()},disabled:!(a.state.list.length>1)},"x"))})},a.save2LocalStorage=function(){var e=a.state,t=e.controls,n=e.light,l=e.volume,o=e.muted,i=e.playbackRate,s=e.playIndex,c=e.viewIndex,r=e.list,d=e.playMode,u=e.playModeSymbol,m=e.played;localStorage.setItem("myList",JSON.stringify(r)),localStorage.setItem("mySettings",JSON.stringify({controls:t,light:n,volume:l,muted:o,playbackRate:i,playIndex:s,viewIndex:c,playMode:d,playModeSymbol:u,played:m}))},a.ref=function(e){a.player=e},a.state={url:"",pip:!1,playing:!1,controls:void 0!==localStorage.mySettings&&JSON.parse(localStorage.mySettings).controls,light:void 0!==localStorage.mySettings&&JSON.parse(localStorage.mySettings).light,volume:void 0===localStorage.mySettings?.5:JSON.parse(localStorage.mySettings).volume,muted:void 0!==localStorage.mySettings&&JSON.parse(localStorage.mySettings).muted,played:0,loaded:0,duration:0,playbackRate:void 0===localStorage.mySettings?1:JSON.parse(localStorage.mySettings).playbackRate,loop:!1,playIndex:void 0===localStorage.mySettings?{album:0,index:0}:JSON.parse(localStorage.mySettings).playIndex,viewIndex:void 0===localStorage.mySettings?{album:0,index:null}:JSON.parse(localStorage.mySettings).viewIndex,list:void 0===localStorage.myList?[{tabName:"default",songList:[]}]:JSON.parse(localStorage.myList),playMode:void 0===localStorage.mySettings?0:JSON.parse(localStorage.mySettings).playMode,playModeSymbol:void 0===localStorage.mySettings?"\ud83d\udd01":JSON.parse(localStorage.mySettings).playModeSymbol,jsonUrl:"data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(void 0===localStorage.myList?[{tabName:"default",songList:[]}]:JSON.parse(localStorage.myList)))},a.handleAddSongToTabActivedDialog=a.handleAddSongToTabActivedDialog.bind(Object(h.a)(Object(h.a)(a))),a.handleAddTabDialog=a.handleAddTabDialog.bind(Object(h.a)(Object(h.a)(a))),a.fileRef=l.a.createRef(),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"handleAddTabDialog",value:function(){var e=this;T().then(function(t){var a=t.output;/\S/.test(a)&&(e.setState({list:[].concat(Object(g.a)(e.state.list),[{tabName:a,songList:[]}])}),e.save2LocalStorage(),e.handleChangeList())},function(){})}},{key:"handleEditTabDialog",value:function(e,t){var a=this;T({name:e}).then(function(e){var n=e.output;if(/\S/.test(n)){var l=a.state.list;l[t].tabName=n,a.setState({list:l}),a.save2LocalStorage(),a.handleChangeList()}},function(){})}},{key:"handleAddSongToTabActivedDialog",value:function(){var e=this;L().then(function(t){var a=t.vid.match(/(?<=^https:\/\/youtu.be\/|^https:\/\/www.youtube.com\/watch\?(.*?)(^|\/|v=)|^)[a-z0-9_-]{11}/gim),n="https://www.youtube.com/watch?v="+(null==a?"":a[0]);if(y.a.canPlay(n)){var l=e.state.list;l[e.state.playIndex.album].songList=[].concat(Object(g.a)(l[e.state.playIndex.album].songList),[{vid:a[0],title:t.title}]),e.setState({list:l}),e.save2LocalStorage(),e.handleChangeList()}},function(){})}},{key:"handleEditSongDialog",value:function(e,t,a){var n=this;L({title:e,vid:t}).then(function(e){var t=e.vid.match(/(?<=^https:\/\/youtu.be\/|^https:\/\/www.youtube.com\/watch\?(.*?)(^|\/|v=)|^)[a-z0-9_-]{11}/gim),l="https://www.youtube.com/watch?v="+(null==t?"":t[0]);if(y.a.canPlay(l)){var o=n.state.list;o[a.album].songList[a.index]={vid:e.vid,title:e.title},n.setState({list:o}),n.save2LocalStorage(),n.handleChangeList()}},function(){})}},{key:"render",value:function(){var e=this,t=this.state,a=t.url,n=t.playing,o=t.controls,i=t.light,s=t.volume,c=t.muted,r=t.loop,d=t.played,u=t.playbackRate,m=t.pip,g=t.playModeSymbol;return l.a.createElement("div",null,l.a.createElement("div",{className:"control-panel"},l.a.createElement("div",{className:"controller"},l.a.createElement("div",{className:"toolbar"},l.a.createElement("div",{className:"toolbar-component"},l.a.createElement("span",{onClick:this.handlePlayPause},n?"\u23f8":"\u25b6")),l.a.createElement("div",{className:"toolbar-component"},l.a.createElement("span",{onClick:this.handleNext},"\u23ed")),l.a.createElement("div",{className:"toolbar-component"},l.a.createElement("span",{onClick:this.handleChangePlayMode},g)),l.a.createElement("div",{className:"toolbar-component"},l.a.createElement("span",{style:{color:"white"}},this.renderTime(d)," "),l.a.createElement("input",{type:"range",min:0,max:.999999,step:"any",value:d,onMouseDown:this.handleSeekMouseDown,onChange:this.handleSeekChange,onMouseUp:this.handleSeekMouseUp})),l.a.createElement("div",{className:"toolbar-component"},l.a.createElement("span",{role:"img",onClick:this.handleToggleMuted},c?"\ud83d\udd07":"\ud83d\udd0a"," "),l.a.createElement("input",{type:"range",min:0,max:1,step:"any",style:{width:"70px"},value:s,onChange:this.handleVolumeChange})),l.a.createElement("div",{className:"toolbar-component",style:{float:"right"}},l.a.createElement("input",{style:{display:"none"},type:"file",accept:".json",className:"my-btn",ref:this.fileRef,onChange:this.loadFile}),l.a.createElement("a",{className:"my-btn",onClick:function(){e.fileRef.current.click()}},"\u532f\u5165"),l.a.createElement("a",{className:"my-btn",href:this.state.jsonUrl,download:"SongList.json"},"\u532f\u51fa"))),l.a.createElement("div",{className:"playlist-tab"},l.a.createElement(f.a,{"aria-label":"Toolbar with button groups"},this.renderTabList(),l.a.createElement(S.a,{size:"sm",variant:"light",onClick:this.handleAddTabDialog},"+"))),l.a.createElement("table",{className:"song-list"},l.a.createElement("thead",null,l.a.createElement("tr",{style:{display:"grid"}},l.a.createElement("th",null,"Title",l.a.createElement("span",{style:{float:"right",background:"gray"},onClick:this.handleAddSongToTabActivedDialog},"Add Song")))),l.a.createElement("tbody",{className:"song-list-body"},this.renderSongList())))),l.a.createElement("div",{className:"player"},l.a.createElement(y.a,{ref:this.ref,url:a,pip:m,playing:n,controls:o,light:i,loop:r,playbackRate:u,volume:s,muted:c,onReady:function(){return console.log("onReady")},onStart:function(){return console.log("onStart")},onPlay:this.handlePlay,onEnablePIP:this.handleEnablePIP,onDisablePIP:this.handleDisablePIP,onPause:this.handlePause,onBuffer:function(){return console.log("onBuffer")},onSeek:function(e){return console.log("onSeek",e)},onEnded:this.handleEnded,onError:function(e){return console.log("onError",e)},onProgress:this.handleProgress,onDuration:this.handleDuration})))}}]),t}(l.a.Component),I=function(e){function t(){return Object(s.a)(this,t),Object(r.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return""}}]),t}(l.a.Component);a(64),a(65);i.a.render(l.a.createElement(function(){return l.a.createElement("div",null,l.a.createElement(m,null),l.a.createElement(j,null),l.a.createElement(I,null))},null),document.getElementById("app"))}},[[45,1,2]]]);
//# sourceMappingURL=main.5b8b1175.chunk.js.map